<h3 class="doc-title">Filter from data base</h3>

<p>
    This example shows how LiveCharts is Linq and MVVM friendly.
</p>

<div class="text-center">
    <img src="/App/Examples/Images/filter.gif"/>
</div>

<p>
    In this example our database returns an array of City class, so we need to configure our chart
    to plot cities.
</p>

<pre class="prettyprint">
public class City
{
  public Guid Id { get; set; }
  public string Name { get; set; }
  public double Population { get; set; }
  public double Density { get; set; }
  public string Country { get; set; }
}
</pre>

<p>
    Add a new window to your solution and replace Window1.cs with the following code:
</p>

<pre class="prettyprint">
using System.ComponentModel;
using System.Linq;
using System.Runtime.CompilerServices;
using System.Windows;
using System.Windows.Controls;
using LiveCharts;
using LiveCharts.Annotations;

public partial class FilterChart : INotifyPropertyChanged
{
  private string[] _labels;

  public FilterChart()
  {
  
    InitializeComponent();
    
    //create a configuration for City class
    var config = new SeriesConfiguration&lt;City&gt;()
                      .Y(city => city.Population); // use Population an Y
                      // X will use default config, a zero based index
            
    //create a series collection with this config
    Series = new SeriesCollection(config);
    
    //lets pull some initials results
    var results = DataBase.Cities.OrderByDescending(city => city.Population).Take(15).ToArray();

    PopulationSeries = new BarSeries
    {
      Title = "Population by city 2015",
      Values = results.AsChartValues(),
      DataLabels = true
    };

    Labels = results.Select(city => city.Name).ToArray();
    Series.Add(PopulationSeries);

    DataContext = this;

  }

  public SeriesCollection Series { get; set; }
  public BarSeries PopulationSeries { get; set; }
  public string Criteria { get; set; }
  public string[] Labels
  {
    get { return _labels; }
    set
    {
      _labels = value;
      OnPropertyChanged();
    }
  }
 
  private void TextBoxBase_OnTextChanged(object sender, TextChangedEventArgs e)
  {
    var c = Criteria.ToUpper();
    var results = DataBase.Cities
                  .Where(city => city.Name.ToUpper().Contains(c) || city.Country.ToUpper().Contains(c))
                  .OrderByDescending(city => city.Population)
                  .Take(15)
                  .ToArray();
    
    Labels = results.Select(city => city.Name).ToArray();
    PopulationSeries.Values = results.AsChartValues();
  }

  public event PropertyChangedEventHandler PropertyChanged;
  [NotifyPropertyChangedInvocator]
  protected virtual void OnPropertyChanged([CallerMemberName] string propertyName = null)
  {
    if (PropertyChanged != null) PropertyChanged.Invoke(this, new PropertyChangedEventArgs(propertyName));
  }
}
</pre>

<p>
    Now add the criteria Textbox and the chart to your Window <i>XAML</i>
</p>

<pre class="prettyprint">
&lt;Grid&gt;
  &lt;Grid.RowDefinitions&gt;
    &lt;RowDefinition Height="Auto"&gt;&lt;/RowDefinition&gt;
    &lt;RowDefinition Height="Auto"&gt;&lt;/RowDefinition&gt;
    &lt;RowDefinition Height="*"&gt;&lt;/RowDefinition&gt;
  &lt;/Grid.RowDefinitions&gt;
  &lt;TextBlock TextWrapping="Wrap"&gt;
    &lt;Bold&gt;Filter from data base&lt;/Bold&gt;: this examples simulates a filter from data base. Type a country or city name to filter from data base
  &lt;/TextBlock&gt;
  &lt;StackPanel Grid.Row="1" Orientation="Horizontal"&gt;
    &lt;TextBlock Margin="5"&gt;Criteria&lt;/TextBlock&gt;
    &lt;TextBox Width="200" Margin="5" Text="{Binding Criteria, UpdateSourceTrigger=PropertyChanged}" TextChanged="TextBoxBase_OnTextChanged"&gt;&lt;/TextBox&gt;
  &lt;/StackPanel&gt;
  &lt;lvc:BarChart Name="Chart" Grid.Row="2" Series="{Binding Series}"&gt;
    &lt;lvc:BarChart.AxisY&gt;
      &lt;lvc:Axis Title="Population" LabelFormatter="{x:Static lvc:LabelFormatters.Number}"&gt;&lt;/lvc:Axis&gt;
    &lt;/lvc:BarChart.AxisY&gt;
    &lt;lvc:BarChart.AxisX&gt;
      &lt;lvc:Axis Title="City" Labels="{Binding Labels}"&gt;&lt;/lvc:Axis&gt;
    &lt;/lvc:BarChart.AxisX&gt;
  &lt;/lvc:BarChart&gt;
&lt;/Grid&gt;
</pre>